<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: RubyOnRails | Git-log-life]]></title>
  <link href="http://dinglixiang.github.com/blog/categories/rubyonrails/atom.xml" rel="self"/>
  <link href="http://dinglixiang.github.com/"/>
  <updated>2013-04-09T22:10:39+08:00</updated>
  <id>http://dinglixiang.github.com/</id>
  <author>
    <name><![CDATA[dinglixiang]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Rails部署在heroku上时错误及解决]]></title>
    <link href="http://dinglixiang.github.com/blog/2013/04/08/railsbu-shu-zai-herokushang-shi-cuo-wu-ji-jie-jue/"/>
    <updated>2013-04-08T20:41:00+08:00</updated>
    <id>http://dinglixiang.github.com/blog/2013/04/08/railsbu-shu-zai-herokushang-shi-cuo-wu-ji-jie-jue</id>
    <content type="html"><![CDATA[<p>在git上运行git push heroku master之后，出现</p>

<pre><code>$ git push heroku master  
Counting objects: 65, done.  
Delta compression using up to 2 threads.  
Compressing objects: 100% (50/50), done.  
Writing objects: 100% (65/65), 86.27 KiB, done.  
Total 65 (delta 3), reused 0 (delta 0)  

-----&gt; Heroku receiving push  
-----&gt; Ruby/Rails app detected  
-----&gt; Installing dependencies using Bundler version 1.2.0.pre  
  Running: bundle install --without development:test --path vendor/bundle --binstubs bin/  
  Fetching gem metadata from       http://rubygems.org/.........  
  Installing rake (0.9.2.2)  
  Installing abstract (1.0.0)  
  Installing activesupport (3.0.7)  
  Installing builder (2.1.2)  
...
  Installing activeresource (3.0.7)  
  Using bundler (1.2.0.pre)  
  Installing thor (0.14.6)  
  Installing railties (3.0.7)  
  Installing rails (3.0.7)  
  Installing sqlite3 (1.3.6) with native extensions  
   Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.  
   /usr/local/bin/ruby extconf.rb  
   checking for sqlite3.h... no  
   sqlite3.h is missing. Try 'port install sqlite3 +universal'  
   or 'yum install sqlite-devel' and check your shared library search path (the location where your sqlite3 shared library is located).  
   *** extconf.rb failed ***  
   Could not create Makefile due to some reason, probably lack of  
   necessary libraries and/or headers.  Check the mkmf.log file for more  
   details.  You may need configuration options.  
   Provided configuration options:  
   --with-opt-dir  
   --without-opt-dir  
   --with-opt-include  
   --without-opt-include=${opt-dir}/include  
   --with-opt-lib  
   --without-opt-lib=${opt-dir}/lib  
   --with-make-prog  
   --without-make-prog  
   --srcdir=.  
   --curdir  
   --ruby=/usr/local/bin/ruby  
   --with-sqlite3-dir  
   --without-sqlite3-dir  
   --with-sqlite3-include  
   --without-sqlite3-include=${sqlite3-dir}/include  
   --with-sqlite3-lib  
   --without-sqlite3-lib=${sqlite3-dir}/lib  
   --enable-local  
   --disable-local  
   Gem files will remain installed in /tmp/build_144lbpbfihqkv/vendor/bundle  
/ruby/1.9.1/gems/sqlite3-1.3.6 for inspection.  
   Results logged to      /tmp/build_144lbpbfihqkv/vendor/bundle/ruby/1.9.1/gems/  
sqlite3-1.3.6/ext/sqlite3/gem_make.out  
   An error occurred while installing sqlite3 (1.3.6), and Bundler cannot continue.  
   Make sure that `gem install sqlite3 -v '1.3.6'` succeeds before bundling.  

 !  
 !     Failed to install gems via Bundler.  
 !  
 !     Heroku push rejected, failed to compile Ruby/rails app  

To git@heroku.com:electric-    waterfall-3720.git  
 ! [remote rejected] master -&gt; master (pre-receive hook declined)  
error: failed to push some refs to 'git@heroku.com:electric-waterfall-3720.git' 
</code></pre>

<p>解决方案：</p>

<p>1、找到项目的gemfile文件，打开之后，修改gem sqlite3为：</p>

<pre><code>gem 'sqlite3', :group =&gt; [:development, :test]
group :production do
  gem 'thin'
  gem 'pg'
end
</code></pre>

<p>2、删除掉gemfile.lock文件</p>

<p>3、运行</p>

<pre><code>bundle install --without production
</code></pre>

<p>4、运行</p>

<pre><code>git add .
</code></pre>

<p>5、运行</p>

<pre><code>git commit -m "bundle updating sqlite3"
</code></pre>

<p>6、运行</p>

<pre><code>git push heroku master
</code></pre>

<p>OK，解决了~~~</p>

<p>参考自:<a href="http://stackoverflow.com/questions/10455527/sqlite3-h-missing-when-pushing-rails-app-to-heroku">http://stackoverflow.com/questions/10455527/sqlite3-h-missing-when-pushing-rails-app-to-heroku</a></p>
]]></content>
  </entry>
  
</feed>
